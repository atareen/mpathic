.. _learn_matrix:

==========================================
``learn_matrix``
==========================================

.. contents::

Overview
-------------
``learn_model`` is a program within the sortseq_tools package which generates
linear or nearest neighbor energy matrix models for sections of a sorted library.
These models can be learned using four methods, designated by using -lm METHOD.
You can choose from Berg Von Hippel (-lm bvh), least squares (-lm leastsq), iterative
least squares (-lm iterative_LS), or mutual information maximization (-lm mi).

After you install `sortseq_tools`_, this program will be available to run at the command line. 

Command-line usage
---------------------
.. argparse::
   :module: sortseq.sortseq_for_doc
   :func: parser
   :prog: sortseq
   :path: learn_model

   

   
Example Input and Output
-----------

The input table to this program must contain a sequences column and counts columns
for each bin. For a sort seq experiment, this can be any number of bins. For MPRA
and selection experiments this must be ct_0 and ct_1.

Example Input Table::

   seq    ct_0     ct_1     ct_2    ...
   ACG    1        5        7
   GGT    8        5        5
   ...

Example Output Table::

   pos    val_A    val_C    val_G     val_T
   0      .04      -.3      -.2       .15
   1      .2       .1       -.44      .05
   ...

Example Command to Run the analysis::
   
    sortseq learn_matrix -i data.txt -lm iterative_LS -s 3 -e 25

.. include:: weblinks.txt
